# Прогнозирование временного ряда температуры

## О проекте

Этот проект посвящён задаче прогнозирования среднесуточной температуры на основе исторических данных. Цель работы — построить и сравнить две модели временных рядов, `AutoReg` и `Prophet`, для предсказания температуры на следующие 730 дней.

## Структура проекта

*   `Forecasting Temperature.ipynb` — Jupyter Notebook, содержащий весь процесс анализа, моделирования и прогнозирования.
*   `temperature.csv` — Исходный файл с данными о температуре (требуется для запуска).
*   `requirements.txt` — Список необходимых библиотек.
*   `README.md` — Данный файл.

## Этапы работы

### 1. Анализ временного ряда

Перед построением моделей был проведён анализ исходных данных:
*   **Визуализация**: Построен график временного ряда, который наглядно продемонстрировал наличие годовой сезонности.
*   **Проверка на стационарность**: С помощью расширенного теста Дики-Фуллера (ADF) было установлено, что ряд является стационарным (p-value < 0.05), что упрощает моделирование.
*   **Анализ автокорреляции**: Рассчитана корреляция ряда со своими предыдущими значениями (лагами). Высокая корреляция с лагом 1 (0.77) и её медленное затухание подтвердили наличие сильной зависимости от предыдущих значений и сезонности.
*   **Анализ выбросов**: С помощью метода межквартильного размаха (IQR) были обнаружены выбросы, которые в дальнейшем были сглажены с использованием скользящего среднего с окном в 14 дней.

### 2. Моделирование и сравнение

Для прогнозирования были использованы две модели:

**а) `AutoReg` (Авторегрессионная модель)**
*   Модель была обучена с учётом 19 лагов и годовой сезонности (период 365 дней).
*   **Результаты**: Модель показала среднее качество прогноза (R² ≈ 0.40), что указывает на то, что она улавливает лишь часть закономерностей в данных.

**б) `Prophet` (библиотека от Facebook)**
*   Модель была сконфигурирована с учётом годовой сезонности и линейного тренда.
*   **Результаты**: `Prophet` показал несколько лучшие результаты по сравнению с `AutoReg` (R² ≈ 0.47). MAE (средняя абсолютная ошибка) составила ~1.99 градуса.

### 3. Выводы

1.  Обе модели успешно уловили основную сезонную компоненту временного ряда.
2.  Модель `Prophet` продемонстрировала более высокое качество прогноза по всем ключевым метрикам (MAE, MSE, R²).
3.  Несмотря на это, итоговое качество обеих моделей остаётся средним. Это говорит о том, что для точного прогнозирования температуры недостаточно одних лишь исторических данных. Для дальнейшего улучшения точности необходимо включать в модель экзогенные факторы, такие как атмосферное давление, влажность, скорость ветра, облачность и т.д.

## Как запустить проект

1.  **Клонируйте репозиторий.**
2.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
3.  **Разместите файл с данными** `temperature.csv` в указанную в ноутбуке директорию или измените путь к файлу.
4.  **Запустите Jupyter Notebook** и выполните ячейки.

Финальный прогноз сохраняется в файл `forecasted_temperature.csv`.
